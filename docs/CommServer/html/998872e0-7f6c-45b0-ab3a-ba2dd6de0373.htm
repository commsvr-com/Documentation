<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>MBUS configuration</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="998872e0-7f6c-45b0-ab3a-ba2dd6de0373" /><meta name="Description" content="The following settings for PC serial COM port are recommended to be used in M-Bus communication:" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">CommServer<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/2dea0752-d490-47e6-8444-ac73e07601fc.htm" title="CommServer" tocid="roottoc">CommServer</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/2dea0752-d490-47e6-8444-ac73e07601fc.htm" title="CommServer" tocid="2dea0752-d490-47e6-8444-ac73e07601fc">CommServer</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/de241950-87e4-40df-ba6c-99579ddc467e.htm" title="Configuration" tocid="de241950-87e4-40df-ba6c-99579ddc467e">Configuration</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/82a59c6f-7225-46b8-be5d-d7517b386965.htm" title="Using NetworkConfig to configure the network" tocid="82a59c6f-7225-46b8-be5d-d7517b386965">Using NetworkConfig to configure the network</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/8b586f8f-6dad-43e6-8b9e-56e5d713fa34.htm" title="Protocol" tocid="8b586f8f-6dad-43e6-8b9e-56e5d713fa34">Protocol</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/998872e0-7f6c-45b0-ab3a-ba2dd6de0373.htm" title="MBUS configuration" tocid="998872e0-7f6c-45b0-ab3a-ba2dd6de0373">MBUS configuration</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/a8c2de7c-5c00-4835-9b36-62bddfeb54be.htm" title="MODBUS IP configuration" tocid="a8c2de7c-5c00-4835-9b36-62bddfeb54be">MODBUS IP configuration</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/1b9d7777-99cc-4059-a57f-124a4d81b498.htm" title="MODBUS RS configuration" tocid="1b9d7777-99cc-4059-a57f-124a4d81b498">MODBUS RS configuration</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/08f7c3a4-0f76-4de5-a067-f471e3d84200.htm" title="SBUS IP configuration" tocid="08f7c3a4-0f76-4de5-a067-f471e3d84200">SBUS IP configuration</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/fbb931d4-5f2b-4368-a78b-45d713fdc684.htm" title="SBUS RS configuration" tocid="fbb931d4-5f2b-4368-a78b-45d713fdc684">SBUS RS configuration</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>MBUS configuration</h1></td></tr></table><span class="introStyle"><A href="http://www.commsvr.com/Products/OPC/CommServer.aspx" title="CommServer online help" target="_blank">Home</A></span> <div class="collapsibleAreaRegion" id="MBUSSerialPortSettings"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Serial port settings</span></div><div id="ID0RBSection" class="collapsibleSection"><div class="mediaCenter"><img alt="Settings for PC serial COM port" src="../media/MBUS_serial_COM_settings.jpg" /><div class="caption"><span class="captionLead">Figure1:
						</span>Settings for PC serial COM port</div></div><p>
         The following settings for PC serial COM port are recommended to be used in M-Bus communication:
        </p><ul><li><p>Baud rate: 2400 bps or 300 bps</p></li><li><p>Parity: Even</p></li><li><p>Data bits:8</p></li><li><p>Stop bit:1</p></li></ul></div><div class="collapsibleAreaRegion" id="MBUSConfigurationAndInterpretationOfReceivedData"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Configuration and interpretation of received data</span></div><div id="ID1RBSection" class="collapsibleSection"><p>M-Bus DataProvider (according to Mode 1) reads data as classes containing records with various types of information. Each M-Bus class is represented in CommServer as a block: blocks contain metadata (description of a  particular record content) and process data. Metadata and data from each record can be made available in the OPC address space as tags. The sequence of tags and tags type shall  correspond to record fields.</p><p>To read a data block, a request with the selected data type (class) and device address on the network is sent to the device (called a station in the CommServer configuration).  The M-Bus device address is configured as a port (interface) address property. </p><p>For the performance reasons, with each class defined by the specification a simplified class is associated that allows to define blocks containing only process data values from the received M-Bus records – metadata is neglected. To publish M-Bus data as OPC tags, the user has to create groups to define the scanning policy, and blocks to define an appropriate class of data. M-Bus DataProvider allows reading the following classes of data:</p><ul><li><p><em>Class2_Data</em> - This class contains process data that are measured by the device,
            </p></li><li><p><em>Class2_Data_Short</em> - This class contains the same data as Class2_Data, but description of data is excluded. Only values of the received data records are returned to CommServer as consecutive tags,
            </p></li><li><p><em>Class1_Data and Class1_Data_Short</em> - – those classes contain data referring to alarms (this version of M-Bus DataProvider does not support Class 1)
            </p></li></ul><p>During configuration of the block, address and name properties are unimportant because they are not used in M-Bus communication. Below find an example of block configuration:</p><div class="mediaCenter"><img alt="Example of block configuration" src="../media/MBUS_block_configuration.jpg" /><div class="caption"><span class="captionLead">Figure2:
						</span>Example of block configuration</div></div><p>After sending a request for data (User Data Class 2), the remote device responds using a frame that is available in CommServer as a block containing the following tags:</p><div class="tableSection"><table><tr><th><p>Index in block</p></th><th><p>Meaning</p></th></tr><tr><td><p>0</p></td><td><p>Counter serial number*</p></td></tr><tr><td><p>1</p></td><td><p>Manufacturer identifier *</p></td></tr><tr><td><p>2</p></td><td><p>Information *</p></td></tr><tr><td><p>3</p></td><td><p>The number of received data records (called N in this manual)*</p></td></tr><tr><td><p>4</p></td><td><p>Record 1 – Value</p></td></tr><tr><td><p>5</p></td><td><p>Record 1 – Description of data type (length in bits, how the value is encoded, etc.)*</p></td></tr><tr><td><p>6</p></td><td><p>Record 1 – Description of data  (e.g. Energy, Volume, Flow, etc.)*</p></td></tr><tr><td><p>7</p></td><td><p>Record 1 – Engineering unit*</p></td></tr><tr><td><p>...</p></td><td><p>...</p></td></tr><tr><td><p>4+(N-1)*4+0</p></td><td><p>Record N – Value</p></td></tr><tr><td><p>4+(N-1)*4+1</p></td><td><p>Record N – Description of data type (length in bits, how the value is encoded, etc...)*</p></td></tr><tr><td><p>4+(N-1)*4+2</p></td><td><p>Record N – Description of data  (e.g. Energy, Volume, Flow, etc.)*</p></td></tr><tr><td><p>4+(N-1)*4+3</p></td><td><p>Record N – Engineering unit*</p></td></tr></table></div><p>Fields marked with an asterisk (*) are not available for data types with “short” postfix, e.g.. <em>Class2_Data_Short</em>.</p></div></div></div><div id="pageFooter" class="pageFooter">This documentation is designed to be used with CAS CommServer (this software is available at <A href="http://www.commsvr.com/DownloadCenter/ProductSoftware/PR2105CommServer_Software.aspx" title="CommServer -multiprotocol, multichannel, redundant communication server – software installation.">http://www.commsvr.com</A>).<p><a href="http://www.commsvr.com/" target="_blank">Copyright © 2008-2020, CAS, All rights reserved</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:techsupp%40cas.eu?Subject=CommServer">CommServer Team</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>