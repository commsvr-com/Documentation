<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>CommServer configuration file (CASOpcDaWrapper.exe.config)</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="a30f63c8-be40-4072-a52a-6f8515ed119e" /><meta name="Description" content="CASOpcDaWrapper.exe.config is the main configuration file of CommServer; please find this file in your CommServer directory. Default location is:" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">CommServer<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/2dea0752-d490-47e6-8444-ac73e07601fc.htm" title="CommServer" tocid="roottoc">CommServer</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/2dea0752-d490-47e6-8444-ac73e07601fc.htm" title="CommServer" tocid="2dea0752-d490-47e6-8444-ac73e07601fc">CommServer</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/de241950-87e4-40df-ba6c-99579ddc467e.htm" title="Configuration" tocid="de241950-87e4-40df-ba6c-99579ddc467e">Configuration</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/a30f63c8-be40-4072-a52a-6f8515ed119e.htm" title="CommServer configuration file (CASOpcDaWrapper.exe.config)" tocid="a30f63c8-be40-4072-a52a-6f8515ed119e">CommServer configuration file (CASOpcDaWrapper.exe.config)</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/82a59c6f-7225-46b8-be5d-d7517b386965.htm" title="Using NetworkConfig to configure the network" tocid="82a59c6f-7225-46b8-be5d-d7517b386965">Using NetworkConfig to configure the network</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/9c5fc843-ce8f-41ad-913c-efa9a731f8ad.htm" title="Additional resources/tools" tocid="9c5fc843-ce8f-41ad-913c-efa9a731f8ad">Additional resources/tools</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/da4e8035-a2bf-4a6f-b55d-f22a46af86fd.htm" title="Database structure" tocid="da4e8035-a2bf-4a6f-b55d-f22a46af86fd">Database structure</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/d2d1c1fe-78f5-4e6d-87e5-bf13c3452b83.htm" title="CommServer time setting recommendations" tocid="d2d1c1fe-78f5-4e6d-87e5-bf13c3452b83">CommServer time setting recommendations</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>CommServer configuration file (CASOpcDaWrapper.exe.config)</h1></td></tr></table><span class="introStyle"><A href="http://www.commsvr.com/Products/OPC/CommServer.aspx" title="CommServer online help" target="_blank">Home</A></span> <div class="collapsibleAreaRegion" id="CSConfigurationFile"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />CommServer configuration file (CASOpcDaWrapper.exe.config)</span></div><div id="ID1RBSection" class="collapsibleSection"><p>CASOpcDaWrapper.exe.config is the main configuration file of CommServer; please find this file in your CommServer directory. Default location is: </p><p>c:\Program Files\CAS\CommServer\CASOpcDaWrapper.exe.config </p><p>You can edit this file using any text editor. An example of the configuration file is shown below:</p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAFABAAA_tab1" class="codeSnippetContainerTabSingle">XML</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAFABAAA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID0EAFABAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAFABAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-xml-bracket">&lt;?</span><span class="highlight-xml-tag">xml</span> <span class="highlight-xml-attribute-name">version</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"1.0"</span> <span class="highlight-xml-attribute-name">encoding</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"utf-8"</span> <span class="highlight-xml-bracket">?&gt;</span>
<span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">configuration</span><span class="highlight-xml-bracket">&gt;</span>
  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">appSettings</span><span class="highlight-xml-bracket">&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">add</span> <span class="highlight-xml-attribute-name">key</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"configfile"</span> <span class="highlight-xml-attribute-name">value</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"comunicationNetXmlDoc.XML"</span> <span class="highlight-xml-bracket">/&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">add</span> <span class="highlight-xml-attribute-name">key</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"MinAvgMax_FrameResponse_management"</span> <span class="highlight-xml-attribute-name">value</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"20"</span> <span class="highlight-xml-bracket">/&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">add</span> <span class="highlight-xml-attribute-name">key</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"MinAvgMax_CharacterGap_management"</span> <span class="highlight-xml-attribute-name">value</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"500"</span> <span class="highlight-xml-bracket">/&gt;</span>
    <span class="highlight-xml-comment">&lt;!-- internal RTLib config part --&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">add</span> <span class="highlight-xml-attribute-name">key</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"PLCNaN"</span> <span class="highlight-xml-attribute-name">value</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"65535"</span> <span class="highlight-xml-bracket">/&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">add</span> <span class="highlight-xml-attribute-name">key</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"MinAvgMax_Tag_management"</span> <span class="highlight-xml-attribute-name">value</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"50"</span> <span class="highlight-xml-bracket">/&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">add</span> <span class="highlight-xml-attribute-name">key</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"MinAvgMax_Group_management"</span> <span class="highlight-xml-attribute-name">value</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"50"</span> <span class="highlight-xml-bracket">/&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">add</span> <span class="highlight-xml-attribute-name">key</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"MinAvgMax_Group_Read_management"</span> <span class="highlight-xml-attribute-name">value</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"50"</span> <span class="highlight-xml-bracket">/&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">add</span> <span class="highlight-xml-attribute-name">key</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"MinAvgMax_Transition_management"</span> <span class="highlight-xml-attribute-name">value</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"50"</span> <span class="highlight-xml-bracket">/&gt;</span> 
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">add</span> <span class="highlight-xml-attribute-name">key</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"WaitForReconnectServerInSec"</span> <span class="highlight-xml-attribute-name">value</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"30"</span> <span class="highlight-xml-bracket">/&gt;</span>
    <span class="highlight-xml-comment">&lt;!-- end of internal RTLib config part --&gt;</span>
  <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">appSettings</span><span class="highlight-xml-bracket">&gt;</span>
<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">configuration</span><span class="highlight-xml-bracket">&gt;</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAFABAAA");</script><p>The following parameters must be set:</p><ul><li><p><em>configfile</em>  – specifies the file, where the communication configuration is saved (default value is “DefaultConfig.xml”; see next chapter for more details)</p></li><li><p><em>MinAvgMax_FrameResponse_management</em> – the value indicates the number of frames when frame response statistics are updated</p></li><li><p><em>MinAvgMax_CharacterGap_management </em> – the value indicates the number of characters (bytes) in a communication channel when Character Gap statistics are updated.
            </p></li></ul><p>Other parameters such as: “PLCNaN”, “MinAvgMax_Tag_management”, “MinAvgMax_Group_management”, “MinAvgMax_Group_Read_management”, “MinAvgMax_Transition_management”, “WaitForReconnectServerInSec” are internal settings of RTLib and should not be changed.</p><p>You can also edit this file to add problem tracing to CommServer and run the software in “debug” mode.</p><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><p><strong>On Windows Server 2003 or 2008 the problem with running CommServer may appear (e.g. the OPC Server address space is empty)</strong></p><p>This issue is caused by missing configuration file. CommServer OPC server executable (CASOpcDaWrapper.exe) is trying to open: “C:\Program Files\CAS\CommServer\CASOpcDaWrapper.config” but this file does not exist. The file that exists in the directory is: “<strong>C:\Program Files\CAS\CommServer\CASOpcDaWrapper.exe.config </strong>”.</p><p>Somehow the system is trying to find .config file (not .exe.config); this situation is different in comparison to the other Windows OS. </p><p>The solution is to create of a copy of the “CASOpcDaWrapper.exe.config” file and rename the copy “CASOpcDaWrapper.config”.</p><p>Before reconnection to OPC server make sure that CASOpcDaWrapper.exe is not appear on the task list (in Windows Task Manager). If it is exist please kill the process before reconnection.</p></td></tr></table></div></div></div></div><div id="pageFooter" class="pageFooter">This documentation is designed to be used with CAS CommServer (this software is available at <A href="http://www.commsvr.com/DownloadCenter/ProductSoftware/PR2105CommServer_Software.aspx" title="CommServer -multiprotocol, multichannel, redundant communication server – software installation.">http://www.commsvr.com</A>).<p><a href="http://www.commsvr.com/" target="_blank">Copyright © 2008-2020, CAS, All rights reserved</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:techsupp%40cas.eu?Subject=CommServer">CommServer Team</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>