<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>OPC connection test</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="bd81e043-6670-4d4a-ba74-e0be1d2822b2" /><meta name="Description" content="After a successful configuration, it is possible to connect to CommServer using an OPC client. Remember that the server does not start itself but it is in ready-to-launch state." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">CommServer<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/2dea0752-d490-47e6-8444-ac73e07601fc.htm" title="CommServer" tocid="roottoc">CommServer</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/2dea0752-d490-47e6-8444-ac73e07601fc.htm" title="CommServer" tocid="2dea0752-d490-47e6-8444-ac73e07601fc">CommServer</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/edfb1894-1b42-4561-a0ca-cd3cf3b37405.htm" title="How to test OPC connection" tocid="edfb1894-1b42-4561-a0ca-cd3cf3b37405">How to test OPC connection</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/04834b85-db9d-4c4c-a6f1-58032fa2ba1e.htm" title="Test target - introduction" tocid="04834b85-db9d-4c4c-a6f1-58032fa2ba1e">Test target - introduction</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/b97056dd-3293-4486-be51-ef7121629f45.htm" title="Preparing for test - computers configuration" tocid="b97056dd-3293-4486-be51-ef7121629f45">Preparing for test - computers configuration</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/bd81e043-6670-4d4a-ba74-e0be1d2822b2.htm" title="OPC connection test" tocid="bd81e043-6670-4d4a-ba74-e0be1d2822b2">OPC connection test</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>OPC connection test</h1></td></tr></table><span class="introStyle"><A href="http://www.commsvr.com/Products/OPC/CommServer.aspx" title="CommServer online help" target="_blank">Home</A></span> <div class="collapsibleAreaRegion" id="CommServerFirstLaunch"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />CommServer first launch</span></div><div id="ID0RBSection" class="collapsibleSection"><p>After a successful configuration, it is possible to connect to CommServer using an OPC client. Remember that the server does not start itself but it is in ready-to-launch state. Connecting to the server from any OPC client is the only method for starting the server. The following entry from the application event viewer (Start Menu -&gt; Run -&gt; eventvwr.msc) proves that the service has started correctly, e.g.:</p><p><em>Communication server started [in the method: .ctor]: product name:CAS.CommServer, Version=3.1.1.0, Culture=neutral, PublicKeyToken=8832ff1a67ea61a3</em></p><p>
          Additionally, in the Windows Task Manager (<em>Start Menu -&gt; Run - &gt; taskmgr</em>) you can check if the "CASOpcDaWrapper" process is running. If so, it means that the OPC server service has been started.
          OPC Viewer client may be used for the first launch of CommServer.
        </p></div><div class="collapsibleAreaRegion" id="OPCViewer"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />OPC Viewer</span></div><div id="ID1RBSection" class="collapsibleSection"><p>In order to start “OPC Viewer” on PC2 select: <em>Start Menu -&gt; All Programs -&gt; CAS -&gt; CommServer -&gt; OPC Viewer</em></p><div class="mediaCenter"><img alt="OPC Viewer - main window" src="../media/GetStart_r01.jpg" /><div class="caption"><span class="captionLead">Figure 1:
						</span>OPC Viewer - main window</div></div><p>To connect to the OPC Server:</p><ol><li><p>
              select &lt;Browse...&gt; from a combo list on the address bar, </p></li><li><p>and then click Add. </p></li></ol><p>Alternatively, click the Browse Network button.</p><div class="mediaCenter"><img alt="OPC Viewer" src="../media/GetStart_r02.jpg" /><div class="caption"><span class="captionLead">Figure 2:
						</span>OPC Viewer</div></div><p>There should appear the “Select Server” window (Figure 3) with the possibility of selecting the OPC server. Select CAS.CommServer.OPC.Da.Server on PC1:</p><div class="mediaCenter"><img alt="Select OPC server window" src="../media/GetStart_r03_2PC.jpg" /><div class="caption"><span class="captionLead">Figure 3:
						</span>Select OPC server window</div></div><p>If a given computer is not on the list, connect to that computer using its IP address and putting it in the address bar:</p><ul><li><p>opcda://adres_ip_komputera/progID_serweraOPC, i.e.</p></li><li><p>opcda://192.168.0.1/CAS.CommServer.OPC.Da.Server**)</p></li></ul><p>**) If the IP address of the test computer is different (e.g. as a result of using the address given by DHCP) write the correct address here. Instead of the address, you may write the computer name, e.g.: opcda://PC1/CAS.CommServer.OPC.Da.Server</p><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><p>please bear in mind that the DCOM model must be configured in a proper way before connecting to another computer. It is also recommended that the account on which the OPC server is to be started should be configured to an interactive user or a user configured to the test needs.</p></td></tr></table></div><p>
          The added server should appear as an element of the OPC Environment tree.
          After the server has been added to the current configuration (session) you can connect thereto:
        </p><ol><li><p>Select the server from the list.</p></li><li><p>Click the “Connect to server” button.</p></li></ol><div class="mediaCenter"><img alt="Connecting to server" src="../media/GetStart_r04.jpg" /><div class="caption"><span class="captionLead">Figure 4:
						</span>Connecting to server</div></div><p>If the connection does not cause an error appearing on the computer screen, you may deem CommServer to be installed correctly. To prove it conclusively, you may start the CommServer Monitor. Select: <em>Start Menu -&gt; All Programs -&gt; CAS-&gt; CommServer-&gt; Server Monitor</em>. Having been started, the application should show a window similar to:</p><div class="mediaCenter"><img alt="Station tab" src="../media/station_tab.jpg" /><div class="caption"><span class="captionLead">Figure 5:
						</span>CommServer Monitor</div></div><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><p>any attempt to start the CommServer Monitor without CommServer running (no client is connected thereto and the CAS.OpcDaWrapper process is missing on the task list) will end with a message informing about a problem with access to data in CommServer. It is a normal situation, as the CommServer Monitor requires a running CommServer to be able to display data from it.</p></td></tr></table></div><p>CommServer is launched with default configuration, which is usually stored in file:  "c:\Program Files\CAS\CommServer\DefaultConfig.xml".</p></div></div></div><div id="pageFooter" class="pageFooter">This documentation is designed to be used with CAS CommServer (this software is available at <A href="http://www.commsvr.com/DownloadCenter/ProductSoftware/PR2105CommServer_Software.aspx" title="CommServer -multiprotocol, multichannel, redundant communication server – software installation.">http://www.commsvr.com</A>).<p><a href="http://www.commsvr.com/" target="_blank">Copyright © 2008-2020, CAS, All rights reserved</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:techsupp%40cas.eu?Subject=CommServer">CommServer Team</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>