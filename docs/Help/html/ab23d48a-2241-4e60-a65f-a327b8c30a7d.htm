<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Walkthrough: Create UA Wrapper</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="ab23d48a-2241-4e60-a65f-a327b8c30a7d" /><meta name="Description" content="Configuration of the CommServer UA to wrap OPC DA server is a straightforward process, which can be done in 5 steps:" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">CommServer<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/2dea0752-d490-47e6-8444-ac73e07601fc.htm" title="CommServer" tocid="roottoc">CommServer</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/a2d55988-b59a-4a87-95b9-933f6bbdf5bd.htm" title="OPC UA Address Space Model Designer" tocid="a2d55988-b59a-4a87-95b9-933f6bbdf5bd">OPC UA Address Space Model Designer</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/f6584b01-23f1-4108-bea5-5cce926bd7ed.htm" title="Using OPC UA Address Space Model Designer" tocid="f6584b01-23f1-4108-bea5-5cce926bd7ed">Using OPC UA Address Space Model Designer</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/10d187b7-b4ca-4f56-bc39-c2bde372629e.htm" title="Data binding" tocid="10d187b7-b4ca-4f56-bc39-c2bde372629e">Data binding</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/cb71ad39-d065-4c9a-9397-7c1e86b63ef1.htm" title="Menu UA Server" tocid="cb71ad39-d065-4c9a-9397-7c1e86b63ef1">Menu UA Server</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/0a1c2521-2ce5-481b-b7f6-d7c0ec395b6c.htm" title="DataBinding properties" tocid="0a1c2521-2ce5-481b-b7f6-d7c0ec395b6c">DataBinding properties</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/07da60d4-d213-4a4a-b498-6bd68c6885b9.htm" title="Walkthrough: Proces DataBinding" tocid="07da60d4-d213-4a4a-b498-6bd68c6885b9">Walkthrough: Proces DataBinding</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/ab23d48a-2241-4e60-a65f-a327b8c30a7d.htm" title="Walkthrough: Create UA Wrapper" tocid="ab23d48a-2241-4e60-a65f-a327b8c30a7d">Walkthrough: Create UA Wrapper</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>Walkthrough: Create UA Wrapper</h1></td></tr></table><span class="introStyle"><A href="http://www.commsvr.com/tabid/55/language/en-US/Default.aspx" title="CommServer online help" target="_blank">Home</A></span> <div class="collapsibleAreaRegion" id="Introduction"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Introduction</span></div><div id="ID0RBSection" class="collapsibleSection"><p>Configuration of the CommServer UA to wrap OPC DA server is a straightforward process, which can be done in 5 steps: </p><ol><li><p>Connect to OPC server using OPC Viewer.</p></li><li><p>Create online subscription in OPC Viewer. </p></li><li><p>Export address space to a dictionary file using OPC Viewer. </p></li><li><p>Create new project in UA Address Space Model Designer and choose configuration plugin. </p></li><li><p>Import OPC DA address space and build the model. </p></li></ol><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><p>OPC Viewer is a free software tool that is very useful for developers, testers, integrators, and other users of the OPC. OPC Viewer has the functionality of saving the current configuration in a file called session. UA Address Space Model Designer is a user-friendly tool supporting all aspects of the model designing process. </p></td></tr></table></div><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><p>Both OPC Viewer and UA Address Space Model Designer are included in:</p><ul><li><p>
                                CommServerUA package which can be downloaded from <a href="http://www.commsvr.com/DownloadCenter/ProductSoftware/CommServerUA/tabid/404/language/en-US/Default.aspx" title="Download CommServer UA" target="_blank">here</a>.
                            </p></li><li><p>
                                UA Address Space Model Designer package which can be downloaded from <a href="http://www.commsvr.com/DownloadCenter/ProductSoftware/UAModelDesigner/tabid/329/language/en-US/Default.aspx" title="Download CAS Address Space Model Designer" target="_blank">here</a>.
                            </p></li></ul><p>In this walkthrough, the CommServerUA package is used.</p></td></tr></table></div></div><div class="collapsibleAreaRegion" id="Prerequisites"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Prerequisites</span></div><div id="ID1RBSection" class="collapsibleSection"><ul><li><p>
                            CommServer is installed (CommServer can be downloaded from <a href="http://www.commsvr.com/DownloadCenter/ProductSoftware/PR2105CommServer_Software/tabid/200/language/en-US/Default.aspx" title="Download CommServer" target="_blank">here</a>)
                        </p></li><li><p>
                            CommServerUA is installed (CommServerUA can be downloaded from <a href="http://www.commsvr.com/DownloadCenter/ProductSoftware/CommServerUA/tabid/404/language/en-US/Default.aspx" title="Download CommServer UA" target="_blank">here</a>)
                        </p></li></ul><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><p>Before installation of the CommServerUA make sure that the following software is installed on your computer:</p><ul><li><p>Microsoft .NET Framework 3.5 Redistributables</p></li><li><p>OPC Core Components</p></li><li><p>Windows 2000/Windows XP/Windows Vista/Windows 7</p></li></ul></td></tr></table></div></div><div class="collapsibleAreaRegion" id="ConnectToOPCServerUsingOPCViewer"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />1. Connect to OPC server using OPC Viewer</span></div><div id="ID2RBSection" class="collapsibleSection"><ol><li><p>To start OPC Viewer, select: </p><p>Start Menu -&gt; All Programs -&gt; CAS -&gt; CommServerUA -&gt; OPC Viewer (OPC DA Classic Client) </p><p>The main window appears. </p></li><li><p>
                            To connect to OPC Server, click “Browse network” icon ( <span class="media"><img alt="Browse Network Icon" src="../media/BrowseNetworkIcon.jpg" /></span> ) in the menu. The Select Server window appears (Figure 1); select OPC Server from a local or remote computer (e.g. CAS.CommServer.OPC.Da.Server):
                        </p><div class="mediaCenter"><img alt="OPCViewer Select Server Window" src="../media/OPCViewerSelectServerWindow.jpg" /><div class="caption"><span class="captionLead">Figure 1:
						</span>OPC Viewer – Select Server window</div></div><p>Select the computer and check what servers are available (to check available servers click on “+” next to the computer name).</p><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><p>Remember to configure DCOM properly before connecting to the other computer. </p></td></tr></table></div><p>
                            The added OPC server is not connected (<span class="media"><img alt="OPCServer Not Connected Icon" src="../media/OPCServerNotConnectedIcon.jpg" /></span>)
                        </p><p>You can add a multiple OPC server to the configuration. It can be also the same OPC server or any other OPC server.</p><div class="mediaCenter"><img alt="OPCViewer MultipleOPCServers" src="../media/OPCViewerMultipleOPCServers.jpg" /><div class="caption"><span class="captionLead">Figure 2:
						</span>OPC Viewer – multiple OPC servers</div></div></li><li><p>
                            Click the right mouse button on the added server and select “Connect” from the context menu or click “Connect to Server” icon ( <span class="media"><img alt="Connect To Server Icon" src="../media/ConnectToServerIcon.jpg" /></span> ) on the toolbar.
                        </p><div class="mediaCenter"><img alt="OPCViewer Connect" src="../media/OPCViewerConnect.jpg" /><div class="caption"><span class="captionLead">Figure 3:
						</span>OPC Viewer – Connect</div></div><p>
                            After successful connection to the OPC server, the icon changes to <span class="media"><img alt="Successful Connection To TheOPCServer Icon" src="../media/SuccessfulConnectionToTheOPCServerIcon.jpg" /></span></p><div class="mediaCenter"><img alt="OPCViewer Successful Connection" src="../media/OPCViewerSuccessfulConnection.jpg" /><div class="caption"><span class="captionLead">Figure 4:
						</span>OPC Viewer – successful connection</div></div><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><p>If OPC server is not connected, an offline subscription can be created.  </p></td></tr></table></div></li><li><p>
                            To check the status of the connected OPC server select “View Status” from the server node context menu or click icon ( <span class="media"><img alt="View Status Icon" src="../media/ViewStatusIcon.jpg" /></span> ) on the toolbar.
                            The Server Status dialog appears:
                        </p><div class="mediaCenter"><img alt="OPCViewer Server Status" src="../media/OPCViewerServerStatus.jpg" /><div class="caption"><span class="captionLead">Figure 5:
						</span>OPC Viewer – Server Status</div></div></li></ol></div><div class="collapsibleAreaRegion" id="CreateOnlineSubscriptionInOPCViewer"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />2. Create online subscription in OPC Viewer</span></div><div id="ID3RBSection" class="collapsibleSection"><ol><li><p>To create a subscription, click the right mouse button on the connected OPC server and select “Create Subscription...-&gt; Browse server…” from the context menu. Create Subscription dialog windows appears. Provide the subscription name and click on “Next” button to continue. </p></li><li><p>Browse a tree view on the left pane (Figure 6) and select requested items. To add an item to a subscription, double click on the item name. When all requested items are added, click on the “Next” button. In the next window, verify the subscription settings (e.g. scanning rate or name) and click on “Done”. </p><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><p>In the process of the UA Wrapper configuration  it is recommended, but not required , that all server items are added to one of the created subscriptions.</p></td></tr></table></div><div class="mediaCenter"><img alt="OPCViewer Adding Tags" src="../media/OPCViewerAddingTags.jpg" /><div class="caption"><span class="captionLead">Figure 6:
						</span>OPC Viewer – adding tags</div></div></li><li><p>Items added to the subscription appear in the OPC viewer main window (Figure 7). </p><div class="mediaCenter"><img alt="OPCViewer Added Items" src="../media/OPCViewerAddedItems.jpg" /><div class="caption"><span class="captionLead">Figure 6:
						</span>OPC Viewer – added items</div></div></li><li><p>Finally the subscription must be saved as a session file (*.oses)  by choosing “Session -&gt; Save” from the menu.</p></li></ol></div><div class="collapsibleAreaRegion" id="ExportAddressSpaceToADictionaryFileUsingOPCViewer"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />3. Export address space to a dictionary file using OPC Viewer</span></div><div id="ID4RBSection" class="collapsibleSection"><ol><li><p>Click the right mouse button on the selected OPC server node and select “Browse Items...” from the context menu. Address Space Dictionary Management dialog appears.</p><div class="mediaCenter"><img alt="OPCViewer Browse Server Items" src="../media/OPCViewerBrowseServerItems.jpg" /><div class="caption"><span class="captionLead">Figure 8:
						</span>OPC Viewer – Browse server items</div></div></li><li><p>Click the "Save" button (Figure 9). In the window that appears, choose "Dictionary files (*.odic)" in the "Save as type" drop-down list and choose location of the *.odic file, where the address space will be saved. </p><div class="mediaCenter"><img alt="OPCViewer Saving The Server Address Space InADictionary File" src="../media/OPCViewerSavingTheServerAddressSpaceInADictionaryFile.jpg" /><div class="caption"><span class="captionLead">Figure 9:
						</span>OPC Viewer – Saving the server address space in a dictionary file</div></div></li><li><p>The created session file and dictionary file will be further used by the Address Space Model Designer to automatically create configuration for the CommServerUA.</p></li></ol></div><div class="collapsibleAreaRegion" id="CreateNewProjectInUAAddressSpaceModelDesignerAndChooseConfigurationEditor"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />4. Create new project in UA Address Space Model Designer and choose configuration editor</span></div><div id="ID5RBSection" class="collapsibleSection"><ol><li><p>1To launch Address Space Model Designer select: </p><p>Start Menu -&gt; All Programs -&gt; CAS -&gt; CommServerUA -&gt; OPC UA Address Space Model Designer</p></li><li><p>After first launching of the UA Address Space Model Designer, the "Help" panel with version history is being displayed. Click on the "Main" panel to manage the solution content. </p></li><li><p>To create new project select “Solution -&gt; Add Project -&gt;New” from the context menu (Figure 10).</p><div class="mediaCenter"><img alt="UAAddress Space Model Designer Create New Project In The Solution" src="../media/UAAddressSpaceModelDesignerCreateNewProjectInTheSolution.jpg" /><div class="caption"><span class="captionLead">Figure 10:
						</span>UA Address Space Model Designer – Create new project in the solution</div></div></li><li><p>Open CommServerUA configuration editor using UA Server menu (figure 11). The default location of this editor is: </p><p><strong>%USERPROFILE%\My Documents\UAAddressSpaceModelDesigner\Sample</strong></p><p>After clicking on the "Open" button the "UA server configuration file" dialog appears. In this walkthrough the configuration is created from scratch using default setting, hence click the "Cancel" button to skip opening a file. </p><p>
                            For more information about using plugins as external configuration editors see <a href="ccefb546-a8cb-4275-9286-c623b04191c3.htm">UA Server configuration</a>.
                        </p><div class="mediaCenter"><img alt="UAAddress Space Model Designer Select Configuration Editor" src="../media/UAAddressSpaceModelDesignerSelectConfigurationEditor.jpg" /><div class="caption"><span class="captionLead">Figure 11:
						</span>UA Address Space Model Designer – Select configuration editor</div></div></li></ol></div><div class="collapsibleAreaRegion" id="ImportOPCDAAddressSpaceAndBuildTheModel"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID6RB')" onkeypress="SectionExpandCollapse_CheckKey('ID6RB', event)" tabindex="0"><img id="ID6RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />5. Import OPC DA address space and build the model</span></div><div id="ID6RBSection" class="collapsibleSection"><ol><li><p>To import address space from DA server to UA model click the right mouse button on the context menu of the "Solution -&gt; Project -&gt; Domain" and select "Import -&gt; From OPC DA ...". </p><div class="mediaCenter"><img alt="Import FromOPCDA" src="../media/ImportFromOPCDA.jpg" /><div class="caption"><span class="captionLead">Figure 12:
						</span>Import from OPC DA</div></div></li><li><p>After clicking on the "From OPC DA ..." you will be asked to open dictionary file (*odic) created above, so choose the file that you have created in <a href="ab23d48a-2241-4e60-a65f-a327b8c30a7d.htm#ExportAddressSpaceToADictionaryFileUsingOPCViewer">section 3</a> Then you will be asked to choose session file (*oses), so choose the file that you have created in <a href="ab23d48a-2241-4e60-a65f-a327b8c30a7d.htm#CreateOnlineSubscriptionInOPCViewer">section 2</a>.</p></li><li><p>Finally you get the fully functional model with the data bindings. Now you can build the model and get all configuration files required for launching CommServerUA. </p></li><li><p>To build the model you need to select "Tools -&gt; Build/Verify -&gt; Build Solution" from the menu bar. Before starting the build operation you will be asked to save the solution file, model file, configuration file and *.csv file (if you did not save those files earlier). </p></li></ol><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><p>If there are any problems with Build process, check if all files have correct names and locations and if there are still problems - reset UA Address Space Model Designer options to default values ("Reset" button is in "Tools -&gt; Options"). </p></td></tr></table></div><p>Now you can use CommServerUA with the configuration similar to your old OPC Classic server. </p></div></div></div><div id="pageFooter" class="pageFooter">This documentation is designed to be used with CAS CommServer (this software is available at <A href="http://www.commsvr.com/index.php/products" title="CommServer -multiprotocol, multichannel, redundant communication server – software installation.">http://www.commsvr.com</A>).<p><a href="http://www.commsvr.com/" target="_blank">Copyright (c) 2019 Mariusz Postol</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:techsupp%40cas.eu?Subject=CommServer">CAS</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>