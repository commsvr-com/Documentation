<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>StateMachines</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="022e0eb8-59d2-4c81-a7d7-3646494f55a2" /><meta name="Description" content="This section describes the basic infrastructure to model state machines. It defines ObjectTypes, VariableTypes and ReferenceTypes and explains how they should be used." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-3.3.1.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">OPC Unified Architecture<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/e34055b2-23e0-4f1a-9e00-52d75becaeec.htm" title="OPC Unified Architecture" tocid="roottoc">OPC Unified Architecture</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/e34055b2-23e0-4f1a-9e00-52d75becaeec.htm" title="Welcome to the OPC Unified Architecture e-book" tocid="e34055b2-23e0-4f1a-9e00-52d75becaeec">Welcome to the OPC Unified Architecture e-book</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/3f999f23-4ad7-46a4-80dd-ab33729d5f49.htm" title="Information Model" tocid="3f999f23-4ad7-46a4-80dd-ab33729d5f49">Information Model</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/c7bb7b37-624e-4a57-a5f3-d7e5994b1fae.htm" title="Introduction" tocid="c7bb7b37-624e-4a57-a5f3-d7e5994b1fae">Introduction</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/0d741b40-7d47-4aa1-852b-fe9007394b7f.htm" title="Standard Object Types" tocid="0d741b40-7d47-4aa1-852b-fe9007394b7f">Standard Object Types</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/d43f206c-8b58-4ded-b9c8-74eaac63cb36.htm" title="Standard Variable Types" tocid="d43f206c-8b58-4ded-b9c8-74eaac63cb36">Standard Variable Types</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/792493fe-9605-478d-b93a-10844c737983.htm" title="Standard Objects and their Variables" tocid="792493fe-9605-478d-b93a-10844c737983">Standard Objects and their Variables</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/2b3534cf-4d77-4d4c-afd5-ab90c0157a66.htm" title="Standard Data Types" tocid="2b3534cf-4d77-4d4c-afd5-ab90c0157a66">Standard Data Types</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/9c0bb318-1a77-4f74-aabc-1c3eb7cfdfc9.htm" title="Design decisions when modelling the server information" tocid="9c0bb318-1a77-4f74-aabc-1c3eb7cfdfc9">Design decisions when modelling the server information</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="../html/022e0eb8-59d2-4c81-a7d7-3646494f55a2.htm" title="StateMachines" tocid="022e0eb8-59d2-4c81-a7d7-3646494f55a2">StateMachines</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="titleColumn"><h1>StateMachines</h1></td></tr></table><span class="introStyle"><A href="http://www.commsvr.com" title="OPC Unified Architecture" target="_blank">Home</A></span> <div class="introduction"><p>This topic contains the following sections:</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#Examples_of_finite_state_machines">Examples of finite state machines</a></li><li class="outlineSectionEntry"><a href="#Definition_of_state_machine">Definition of state machine</a></li><li class="outlineSectionEntry"><a href="#Representation_of_state_machines">
        Representation of state machines in the Address Space</a></li><li class="outlineSectionEntry"><a href="#Examples_of_StateMachines">Examples of StateMachines in the address space</a></li></ul><p>
        This section describes the basic infrastructure to model state machines. It defines ObjectTypes, VariableTypes and ReferenceTypes and explains how they should be used.
      </p><p>
        This section is normative, i.e. the types defined in the section have to be used as defined. However, it is not required but strongly recommended that a server uses these types to expose its state machines. The defined types may be subtyped to refine their behaviour.
      </p><p>
        The scope of the state machines described in this section is to provide an appropriate foundation for state machines needed by
        section <a href="2ba1f4ae-e619-4821-87ae-8b1073901d99.htm">Alarms and Conditions</a>
        and
        section <a href="96ffa07e-22ab-4d77-a1ae-e476e54a5b63.htm">Programs</a>
        . It does not provide more complex functionality of a state machine like parallel states, forks and joins, history states, choices and junctions etc. However, the base state machine defined in this section can be extended to support such concepts.
      </p><p>
        The following clauses describe examples of state machines, define state machines in the context of this section and define the representation of state machines in OPC Unified Architecture. Finally, some examples of state machines, represented in OPC Unified Architecture, are given.
      </p></div><div class="collapsibleAreaRegion" id="Examples_of_finite_state_machines"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Examples of finite state machines</span></div><div id="ID0RBSection" class="collapsibleSection"><p>This section contains the following subsections:</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#Simple_state_machine">Simple state machine</a></li><li class="outlineSectionEntry"><a href="#State_machine_containing_substates">State machine containing substates</a></li></ul><p /><h4 class="subHeading" id="Simple_state_machine">Simple state machine</h4><div class="subsection"><p>
              The following example provides an overview of the base features that the state machines defined in this Appendix will support. In the following a more complex example is given, that also supports sub-state machines.
            </p><p>
              Figure 1 gives an overview over a simple state machine. It contains the three states “State1”, “State2” and “State3”. There are transitions from “State1” to “State2”, “State2” to “State2”, etc. Some of the transitions provide additional information with regard to what causes (or triggers) the transition, e.g. the call of “Method1” for the transition from “State1” to “State2”. The effect (or action) of the transition can also be specified, e.g. the generation of an Event of the “EventType1” in the same transition. The notation used to identify the cause is simply listing it on the transition, the effect is prefixed with a “/”. More than one cause or effect are separated by a “,”. Not every transition has to have a cause or effect, for example the transition between “State2” and “State3”.
            </p><div class="mediaCenter"><img alt="Example of a simple state machine" src="../media/ExampleOfaSimpleStateMachine.JPG" /><div class="caption"><span class="captionLead">Figure 1:
						</span>Example of a simple state machine</div></div><p>For simplicity, the state machines described in this section will only support causes in form of specifying Methods that have to be called and effects in form of EventTypes of Events that are generated. However, the defined infrastructure allows extending this to support additional different causes and effects.</p></div><h4 class="subHeading" id="State_machine_containing_substates">State machine containing substates</h4><div class="subsection"><p>
              Figure 2 shows an example of a state machine where “State6” is a sub-state-machine. This means, that when the overall state machine is in State6, this state can be distinguish to be in the sub-states “State7” or “State8”. Sub-state-machines can be nested, i.e. “State7” could be another sub-state-machine.
            </p><div class="mediaCenter"><img alt="Example of a state machine having a sub-machine" src="../media/ExampleStateMachineHavingSub-machine.JPG" /><div class="caption"><span class="captionLead">Figure 2:
						</span>Example of a state machine having a sub-machine</div></div></div></div><div class="collapsibleAreaRegion" id="Definition_of_state_machine"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Definition of state machine</span></div><div id="ID1RBSection" class="collapsibleSection"><p>
          The infrastructure of state machines defined in this section only deals with the basics of state machines needed to support
          section <a href="2ba1f4ae-e619-4821-87ae-8b1073901d99.htm">Alarms and Conditions</a>
          and
          section <a href="96ffa07e-22ab-4d77-a1ae-e476e54a5b63.htm">Programs</a>
          . The intention is to keep the basic simple but extensible.
        </p><p>
          For the state machines defined in this section we assume that state machines are typed and instances of a type have their states and semantics specified by the type. For some types this means that the states and transitions are fixed. For other types the states and transitions may be dynamic or unknown. A state machine where all the states are specified explicitly by the type is called a finite state machine.
        </p><p>
          Therefore we distinguish between StateMachineType and StateMachine. The StateMachineType specifies a description of the state machine – its states, transitions, etc. – whereas the StateMachine is an instance of the StateMachineType and only contains the current state.
        </p><p>
          Each StateMachine contains information about the current state. If the StateMachineType has SubStateMachines, the StateMachine also contains information about the current state of the SubStateMachines. StateMachines which have their states completely defined by the type are instances of a FiniteStateMachineType.
        </p><p>
          Each FiniteStateMachineType has one or more States. For simplicity we do not distinguish between different States like the start or the end states.
        </p><p>
          Each State can have one or more SubStateMachines.
        </p><p>
          Each FiniteStateMachineType may have one or more Transitions. A Transition is directed and points from one State to another State.
        </p><p>
          Each Transition can have one or more Causes. A Cause leads a FiniteStateMachine to change its current State from the source of the Transition to its target. In this Appendix we only specify Method calls to be Causes of Transitions. Transitions do not have to have a Cause. A Transition can always be caused by some server-internal logic that is not exposed in the Address Space.
        </p><p>
          Each Transition can have one or more Effects. An Effect occurs if the Transition is used to change the State of a StateMachine. In this Appendix we only specify the generation of Events to be Effects of a Transition. A Transition is not required to expose any Effects in the Address Space.
        </p><p>
          Although this section only specifies simple concepts for state machines, the provided infrastructure is extensible. If needed, special States can be defined as well as additional Causes or Effects.
        </p></div><div class="collapsibleAreaRegion" id="Representation_of_state_machines"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />
        Representation of state machines in the Address Space</span></div><div id="ID2RBSection" class="collapsibleSection"><p>This section contains the following subsections:</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#Overview">Overview</a></li><li class="outlineSectionEntry"><a href="#StateMachineType">StateMachineType</a></li><li class="outlineSectionEntry"><a href="#StateVariableType">StateVariableType</a></li><li class="outlineSectionEntry"><a href="#TransitionVariableType">TransitionVariableType</a></li><li class="outlineSectionEntry"><a href="#FiniteStateMachineType">FiniteStateMachineType</a></li><li class="outlineSectionEntry"><a href="#FiniteStateVariableType">FiniteStateVariableType</a></li><li class="outlineSectionEntry"><a href="#FiniteTransitionVariableType">FiniteTransitionVariableType</a></li><li class="outlineSectionEntry"><a href="#StateType">StateType</a></li><li class="outlineSectionEntry"><a href="#InitialStateType">InitialStateType</a></li><li class="outlineSectionEntry"><a href="#TransitionTypeateType">TransitionTypeateType</a></li><li class="outlineSectionEntry"><a href="#FromState">FromState</a></li><li class="outlineSectionEntry"><a href="#ToState">ToState</a></li><li class="outlineSectionEntry"><a href="#HasCause">HasCause</a></li><li class="outlineSectionEntry"><a href="#HasEffect">HasEffect</a></li><li class="outlineSectionEntry"><a href="#HasSubStateMachine">HasSubStateMachine</a></li><li class="outlineSectionEntry"><a href="#TransitionEventType">TransitionEventType</a></li><li class="outlineSectionEntry"><a href="#AuditUpdateStateEventType">AuditUpdateStateEventType</a></li><li class="outlineSectionEntry"><a href="#Special_Restrictions_on_subtyping_StateMachines">Special Restrictions on subtyping StateMachines</a></li></ul><p /><h4 class="subHeading" id="Overview">Overview</h4><div class="subsection"><p>
              The types defined in this section are illustrated in Figure 3. The MyFiniteStateMachineType is a minimal example which illustrates how these Types can be used to describe a StateMachine. See
              section <a href="2ba1f4ae-e619-4821-87ae-8b1073901d99.htm">Alarms and Conditions</a>
              for additional examples of StateMachines.
            </p><div class="mediaCenter"><img alt="The StateMachine Information Model" src="../media/StateMachineInformationModel.JPG" /><div class="caption"><span class="captionLead">Figure 3:
						</span>The StateMachine Information Model</div></div></div><h4 class="subHeading" id="StateMachineType">StateMachineType</h4><div class="subsection"><p>
              The StateMachineType is the base <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> for all StateMachineTypes. It defines a single <a href="5ed97e29-a505-4050-af5d-8b2c8d80a045.htm">Variable</a> which represents the current state of the machine. An instance of this <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> shall generate an Event whenever a significant state change occurs. The Server decides which state changes are significant. Servers shall use the <a href="57be83ea-0aac-4456-b29a-0b18a8467134.htm#GeneratesEvent">GeneratesEvent</a><a href="4044403d-3a21-40cc-a508-b2d17a10b62d.htm">ReferenceType</a> to indicate which Event(s) could be produced by the StateMachine.
            </p><p>
              Subtypes may add Methods which affect the state of the machine. The Executable Attribute is used to indicate whether the Method is valid given the current state of the machine. The generation of AuditEvents for Methods is described in section <a href="ef0092b5-9f31-4e8d-9901-270be06e6577.htm">Services</a>. A StateMachine may not be active. In this case, the CurrentState and LastTransition Variables shall have a status equal to Bad_StateNotActive.
            </p><p>
              Subtypes may add components which are instances of StateMachineTypes. These components are considered to be sub-states of the StateMachine. SubStateMachines are only active when the parent machine is in an appropriate state.
            </p><p><strong>Events</strong> produced by SubStateMachines may be suppressed by the parent machine. In some cases, the parent machine will produce a single Event that reflects changes in multiple SubStateMachines.
            </p><p><strong>FiniteStateMachineType</strong> is subtype of StateMachineType that provides a mechanism to explicitly define the states and transitions. A Server should use this mechanism if it knows what the possible states are and the state machine is not trivial.
            </p><p><strong>CurrentState</strong> stores the current state of an instance of the StateMachineType. CurrentState provides a human readable name for the current state which may not be suitable for use in application control logic. Applications should use the Id Property of CurrentState if they need a unique identifier for the state.
            </p><p><strong>LastTransition</strong> stores the last transition which occurred in an instance of the StateMachineType. LastTransition provides a human readable name for the last transition which may not be suitable for use in application control logic. Applications should use the Id Property of LastTransition if they need a unique identifier for the transition.
            </p></div><h4 class="subHeading" id="StateVariableType">StateVariableType</h4><div class="subsection"><p>
              The StateVariableType is the base <a href="1bc63c28-33da-4c76-b8f6-8df43f0a776f.htm">VariableType</a> for Variables that store the current state of a StateMachine as a human readable name
            </p><p><strong>Id</strong> is a name which uniquely identifies the current state within the StateMachineType. A subtype may restrict the DataType.
            </p><p><strong>Name</strong> is a QualifiedName which uniquely identifies the current state within the StateMachineType.
            </p><p><strong>Number</strong> is an integer which uniquely identifies the current state within the StateMachineType.
            </p><p><strong>EffectiveDisplayName</strong> contains a human readable name for the current state of the state machine after taking the state of any SubStateMachines in account. There is no rule specified for which state or sub-state should be used. It is up to the server and will depend on the semantics of the StateMachineType.
            </p><p>
              StateMachines produce Events which may include the current state of a StateMachine. In that case servers shall provide all the optional Properties of the StateVariableType in the Event, even if they are not provided on the instances in the Address Space.
            </p></div><h4 class="subHeading" id="TransitionVariableType">TransitionVariableType</h4><div class="subsection"><p>
              The TransitionVariableType is the base <a href="1bc63c28-33da-4c76-b8f6-8df43f0a776f.htm">VariableType</a> for Variables that store a Transition that occurred within a StateMachine as a human readable name.
            </p><p>
              The SourceTimestamp for the value specifies when the Transition occurred. This value may also be exposed with the TransitionTime Property.
            </p><p><strong>Id</strong> is a name which uniquely identifies a Transition within the StateMachineType. A subtype may restrict the DataType.
            </p><p><strong>Name</strong> is a QualifiedName which uniquely identifies a transition within the StateMachineType.
            </p><p><strong>Number</strong> is an integer which uniquely identifies a transition within the StateMachineType.
            </p><p><strong>TransitionTime</strong> specifies when the transition occurred.
            </p></div><h4 class="subHeading" id="FiniteStateMachineType">FiniteStateMachineType</h4><div class="subsection"><p>
              The FiniteStateMachineType is the base <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> for StateMachines that explicitly define the possible States and Transitions. Once the States are defined subtypes shall not add new States
            </p><p>
              The States of the machine are represented with instances of the StateType <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a>. Each State shall have a <a href="467e8ac2-46d8-4758-8965-a891200787ee.htm#BrowseName">BrowseName</a> which is unique within the StateMachine and shall have a StateNumber which shall also be unique across all States defined in the StateMachine. A concrete subtype of FiniteStateMachineType shall define at least one State.
            </p><p>
              A StateMachine may define one State which is an instance of the InitialStateType. This State is the State that the machine goes into when it is activated.
            </p><p>
              The Transitions that may occur are represented with instances of the TransitionType. Each Transition shall have a <a href="467e8ac2-46d8-4758-8965-a891200787ee.htm#BrowseName">BrowseName</a> which is unique within the StateMachine and may have a TransitionNumber which shall also be unique across all Transitions defined in the StateMachine.
            </p><p>
              The initial State for a Transition is a StateType Object which is the target of a FromState Reference. The final State for a Transition is a StateType Object which is the target of a ToState Reference. The FromState and ToState References shall always be specified.
            </p><p>
              A Transition may produce an Event. The Event is indicated by a HasEffect Reference to a subtype of <a href="f430b65b-e139-41d1-a250-269480d3e36c.htm#BaseEventType">BaseEventType</a>. The StateMachineType shall have <a href="57be83ea-0aac-4456-b29a-0b18a8467134.htm#GeneratesEvent">GeneratesEvent</a> References to the targets of a HasEffect Reference for each of its Transitions.
            </p><p>
              A FiniteStateMachineType may define Methods that cause a transition to occur. These Methods are targets of HasCause References for each of the Transitions that may be triggered by the Method. The Executable Attribute for a Method is used to indicate whether the current State of the machine allows the Method to be called.
            </p><p>
              A FiniteStateMachineType may have sub-state-machines which are represented as instances of StateMachineType ObjectTypes. Each State shall have a HasSubStateMachine Reference to the StateMachineType Object which represents the child States. The SubStateMachine is not active if the parent State is not active.
            </p></div><h4 class="subHeading" id="FiniteStateVariableType">FiniteStateVariableType</h4><div class="subsection"><p>
              The FiniteStateVariableType is a subtype of StateVariableType and is used to store the current state of a FiniteStateMachine as a human readable name
            </p><p><strong>Id</strong> is inherited from the StateVariableType and overridden to reflect the required DataType. This value shall be the <a href="546f49d5-8153-434c-9e74-d7835d7862bc.htm#NodeId">NodeId</a> of one of the State Objects of the FiniteStateMachineType.
            </p><p><strong>Name</strong> inherited from StateVariableType shall be the <a href="467e8ac2-46d8-4758-8965-a891200787ee.htm#BrowseName">BrowseName</a> of one of the State Objects of the FiniteStateMachineType.
            </p><p><strong>Number</strong> inherited from StateVariableType shall be the StateNumber for one of the State Objects of the FiniteStateMachineType
            </p></div><h4 class="subHeading" id="FiniteTransitionVariableType">FiniteTransitionVariableType</h4><div class="subsection"><p>
              The FiniteTransitionVariableType is a subtype of TransitionVariableType and is used to store a Transition that occurred within a FiniteStateMachine as a human readable name.
            </p><p><strong>Id</strong> is inherited from the TransitionVariableType and overridden to reflect the required DataType. This value shall be the <a href="546f49d5-8153-434c-9e74-d7835d7862bc.htm#NodeId">NodeId</a> of one of the Transition Objects of the FiniteStateMachineType.
            </p><p><strong>Name</strong> inherited from the TransitionVariableType shall be the <a href="467e8ac2-46d8-4758-8965-a891200787ee.htm#BrowseName">BrowseName</a> of one of the Transition Objects of the FiniteStateMachineType.
            </p><p><strong>Number</strong> inherited from the TransitionVariableType shall be the TransitionNumber for one of the Transition Objects of the FiniteStateMachineType.
            </p></div><h4 class="subHeading" id="StateType">StateType</h4><div class="subsection"><p>
              States of a FiniteStateMachine are represented as Objects of the StateType
            </p></div><h4 class="subHeading" id="InitialStateType">InitialStateType</h4><div class="subsection"><p>
              The InitialStateType is a subtype of the StateType and is formally defined in Table 148. An Object of the InitialStateType represents the State that a FiniteStateMachine enters when it activated. Each FiniteStateMachine can have at most one State of type InitialStateType, but a FiniteStateMachine does not have to have a State of this type.
            </p><p>
              A StateMachine goes into its initial state whenever the parent state is entered. However, a state machine may define a transition that goes directly to a state of the SubStateMachine. In this case the SubStateMachine goes into that State instead of the initial State. The two scenarios are illustrated in Figure 4. The transition from State5 to State6 causes the SubStateMachine to go into the initial State (State7), however, the transition from State4 to State8 causes the parent machine to go to State6 and the SubStateMachine will go to State8.
            </p><div class="mediaCenter"><img alt="Example of an initial State in a sub-machine" src="../media/ExampleInitialStateSub-machine.JPG" /><div class="caption"><span class="captionLead">Figure 4:
						</span>Example of an initial State in a sub-machine</div></div><p>
              If no initial state for a SubStateMachine exists and the State having the SubStateMachine is entered directly, then the State of the SubStateMachine is server specific.
            </p></div><h4 class="subHeading" id="TransitionTypeateType">TransitionTypeateType</h4><div class="subsection"><p>
              Transitions of a FiniteStateMachine are represented as Objects of the <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> TransitionType.
            </p><p>
              Each valid Transition shall have exactly one FromState Reference and exactly one ToState Reference, each pointing to an Object of the <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> StateType.
            </p><p>
              Each Transition can have one or more HasCause References pointing to the cause that triggers the Transition.
            </p><p>
              Each Transition can have one or more HasEffect References pointing to the effects that occur when the Transition was triggered.
            </p></div><h4 class="subHeading" id="FromState">FromState</h4><div class="subsection"><p>
              The FromState is a concrete reference type and can be used directly. It is a subtype of NonHierarchicalReferences.
            </p><p>
              The semantic of this type is to point form a Transition to the starting State the Transition connects.
            </p><p>
              The SourceNode of this <a href="4044403d-3a21-40cc-a508-b2d17a10b62d.htm">ReferenceType</a> shall be an Object of the <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> TransitionType or one of its subtypes. The TargetNode of this <a href="4044403d-3a21-40cc-a508-b2d17a10b62d.htm">ReferenceType</a> shall be an Object of the <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> StateType or one of its subtypes.
            </p><p>
              Each Transition can have one or more HasEffect References pointing to the effects that occur when the Transition was triggered.
            </p></div><h4 class="subHeading" id="ToState">ToState</h4><div class="subsection"><p>
              The ToState is a concrete reference type and can be used directly. It is a subtype of NonHierarchicalReferences.
            </p><p>
              The semantic of this  type is to point form a Transition to the ending State the Transition connects.
            </p><p>
              The source node of this <a href="4044403d-3a21-40cc-a508-b2d17a10b62d.htm">ReferenceType</a> shall be an Object of the <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> TransitionType or one of its subtypes. The target node of this <a href="4044403d-3a21-40cc-a508-b2d17a10b62d.htm">ReferenceType</a> shall be an Object of the <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> StateType or one of its subtypes.
            </p><p>
              References of this <a href="4044403d-3a21-40cc-a508-b2d17a10b62d.htm">ReferenceType</a> may be only exposed uni-directional. Sometimes this is required, for example, if a Transition points to a State of a sub-machine.
            </p></div><h4 class="subHeading" id="HasCause">HasCause</h4><div class="subsection"><p>
              The HasCause type is a concrete reference type and can be used directly. It is a subtype of NonHierarchicalReferences.
            </p><p>
              The semantic of this type is to point form a Transition to something that causes the Transition. In this Appendix we only define Methods as Causes. However, the <a href="4044403d-3a21-40cc-a508-b2d17a10b62d.htm">ReferenceType</a> is not restricted to point to Methods.
            </p><p>
              The source node of this <a href="4044403d-3a21-40cc-a508-b2d17a10b62d.htm">ReferenceType</a> shall be an Object of the <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> TransitionType or one of its subtypes. The TargetNode can be of any <a href="467e8ac2-46d8-4758-8965-a891200787ee.htm">node class</a>.
            </p></div><h4 class="subHeading" id="HasEffect">HasEffect</h4><div class="subsection"><p>
              The HasEffect is a concrete reference type and can be used directly. It is a subtype of NonHierarchicalReferences.
            </p><p>
              The semantic of this reference type is to point form a Transition to something that will be effected when the Transition is triggered. In this Appendix we only define EventTypes as Effects. However, the <a href="4044403d-3a21-40cc-a508-b2d17a10b62d.htm">ReferenceType</a> is not restricted to point to EventTypes.
            </p><p>
              The source node of this <a href="4044403d-3a21-40cc-a508-b2d17a10b62d.htm">ReferenceType</a> shall be an Object of the <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> TransitionType or one of its subtypes. The TargetNode can be of any <a href="467e8ac2-46d8-4758-8965-a891200787ee.htm">node class</a>.
            </p></div><h4 class="subHeading" id="HasSubStateMachine">HasSubStateMachine</h4><div class="subsection"><p>
              The HasSubStateMachine is a concrete type and can be used directly. It is a subtype of NonHierarchicalReferences.
            </p><p>
              The semantic of this type is to point from a State to an instance of a StateMachineType which represents the sub-states for the State.
            </p><p>
              The SourceNode of this <a href="4044403d-3a21-40cc-a508-b2d17a10b62d.htm">ReferenceType</a> shall be an Object of the <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> StateType. The TargetNode shall be an Object of the <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> StateMachineType or one of its subtypes. Each Object can be the TargetNode of at most one HasSubStateMachine Reference.
            </p><p>
              The SourceNode (the state) and the TargetNode (the SubStateMachine) shall belong to the same StateMachine, i.e. both shall be referenced from the same Object of type StateMachineType using a <a href="57be83ea-0aac-4456-b29a-0b18a8467134.htm#HasComponent">HasComponent</a> Reference or a subtype of <a href="57be83ea-0aac-4456-b29a-0b18a8467134.htm#HasComponent">HasComponent</a>.
            </p></div><h4 class="subHeading" id="TransitionEventType">TransitionEventType</h4><div class="subsection"><p>
              The TransitionEventType is a subtype of the <a href="f430b65b-e139-41d1-a250-269480d3e36c.htm#BaseEventType">BaseEventType</a>. It can be used to generate an Event identifying that a Transition of a StateMachine was triggered.
            </p><p>
              The TransitionEventType inherits the Properties of the <a href="f430b65b-e139-41d1-a250-269480d3e36c.htm#BaseEventType">BaseEventType</a>.
            </p><p>
              The inherited Property SourceNode shall be filled with the <a href="546f49d5-8153-434c-9e74-d7835d7862bc.htm#NodeId">NodeId</a> of the StateMachine instance were the Transition occurs. If the Transition occurs in a SubStateMachine, then the <a href="546f49d5-8153-434c-9e74-d7835d7862bc.htm#NodeId">NodeId</a> of the SubStateMachine has to be used. If the Transition occurs between a StateMachine and a SubStateMachine, then the <a href="546f49d5-8153-434c-9e74-d7835d7862bc.htm#NodeId">NodeId</a> of the StateMachine has to be used, independent of the direction of the Transition.
            </p><p><strong>Transition</strong> identifies the Transition that triggered the Event.
            </p><p><strong>FromState</strong> identifies the State before the Transition.
            </p><p><strong>ToState</strong> identifies the State after the Transition.
            </p></div><h4 class="subHeading" id="AuditUpdateStateEventType">AuditUpdateStateEventType</h4><div class="subsection"><p>
              The AuditUpdateStateEventType is a subtype of the AuditUpdateMethodEventType. It can be used to generate an Event identifying that a Transition of a StateMachine was triggered.
            </p><p>
              The AuditUpdateStateEventType inherits the Properties of the AuditUpdateMethodEventType.
            </p><p>
              The inherited Property SourceNode shall be filled with the <a href="546f49d5-8153-434c-9e74-d7835d7862bc.htm#NodeId">NodeId</a> of the StateMachine instance were the State changed. If the State changed in a SubStateMachine, then the <a href="467e8ac2-46d8-4758-8965-a891200787ee.htm#NodeId">NodeId</a> of the SubStateMachine has to be used.
            </p><p>
              The SourceName for Events of this type should be the effect that generated the event (e.g. the name of a Method). If the effect was generated by a Method call, the SourceName should be the name of the Method prefixed with “Method/”.
            </p><p><strong>OldStateId</strong> reflects the Id of the state prior the change.
            </p><p><strong>NewStateId</strong> reflects the new Id of the state after the change.
            </p></div><h4 class="subHeading" id="Special_Restrictions_on_subtyping_StateMachines">Special Restrictions on subtyping StateMachines</h4><div class="subsection"><p>
              In general, all rules on subtyping apply for StateMachine types as well. Some additional rules apply for StateMachine types. If a StateMachine type is not abstract, subtypes of it shall not change the behaviour of it. That means, that in that case a subtype shall not add States and it shall not add Transitions between its States. However, a subtype may add SubStateMachines, it may add Transitions from the States to the States of the SubStateMachine, and it may add Causes and Effects to a Transition. In addition, a subtype of a StateMachine type shall not remove States or Transitions.
            </p></div></div><div class="collapsibleAreaRegion" id="Examples_of_StateMachines"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Examples of StateMachines in the address space</span></div><div id="ID3RBSection" class="collapsibleSection"><p>This section contains the following subsections:</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#StateMachineType_using_inheritance">
            StateMachineType using inheritance
          </a></li><li class="outlineSectionEntry"><a href="#StateMachineType_with_a_sub-machine_using_inheritance">
            StateMachineType with a sub-machine using inheritance
          </a></li><li class="outlineSectionEntry"><a href="#StateMachineType_using_containment">
            StateMachineType using containment
          </a></li><li class="outlineSectionEntry"><a href="#Example_of_a_StateMachine_having_Transitions_to_SubStateMachines">
            Example of a StateMachine having Transitions to SubStateMachines
          </a></li></ul><h4 class="subHeading" id="StateMachineType_using_inheritance">
            StateMachineType using inheritance
          </h4><div class="subsection"><div class="mediaCenter"><img alt="Example of a StateMachineType using inheritance" src="../media/Example StateMachineTypeUsingInheritance.JPG" /><div class="caption"><span class="captionLead">Figure 5:
						</span>Example of a StateMachineType using inheritance</div></div><p>
              In Figure 5 an example of a StateMachine is given using the Notation described in the section of section <a href="58e663ae-9e77-4a9b-9adc-cbc18c4d7e9e.htm">Address Space</a>. First, a new StateMachineType is defined, called “MyStateMachineType”, inheriting from the base FiniteStateMachineType. It contains two States, “State1” and “State2” and a Transition “Transition1” between them. The Transition points to a Method “MyMethod” as the Cause of the Transition and an <a href="61bf86cb-8e76-408c-952f-ab6960eb96b8.htm#EventType">event type</a> “EventType1” as the Effect of the Transition.
            </p><p>
              Instances of “MyStateMachineType” can be created, for example “MyStateMachine”. It has a <a href="5ed97e29-a505-4050-af5d-8b2c8d80a045.htm">Variable</a> “CurrentState” representing the current State. The “MyStateMachine” Object only includes the Nodes which expose information specific to the instance.
            </p></div><h4 class="subHeading" id="StateMachineType_with_a_sub-machine_using_inheritance">
            StateMachineType with a sub-machine using inheritance
          </h4><div class="subsection"><div class="mediaCenter"><img alt="Example of a StateMachineType with a SubStateMachine using inheritance" src="../media/Example StateMachineTypeaSubStateMachineUsingInheritance.JPG" /><div class="caption"><span class="captionLead">Figure 6:
						</span>Example of a StateMachineType with a SubStateMachine using inheritance</div></div><p>
              Figure 6 gives an example of a StateMachineType having a SubStateMachine for its “State1”. For simplicity no effects and causes are shown, as well as type information for the States or ModellingRules.
            </p><p>
              The “MyStateMachineType” contains an Object “MySubMachine” of type “AnotherStateMachineType” representing a SubStateMachine. The “State1” references this Object with a HasSubStateMachine Reference, thus it is a SubStateMachine of “State1”. Since “MySubMachine” is an Object of type “AnotherStateMachineType” it has a <a href="5ed97e29-a505-4050-af5d-8b2c8d80a045.htm">Variable</a> representing the current State. Since it is used as an InstanceDeclaration, no value is assigned to this <a href="5ed97e29-a505-4050-af5d-8b2c8d80a045.htm">Variable</a>.
            </p><p>
              An Object of “MyStateMachineType”, called “MyStateMachine” has Variables for the current State, but also has an Object “MySubMachine” and a <a href="5ed97e29-a505-4050-af5d-8b2c8d80a045.htm">Variable</a> representing the current state of the SubStateMachine. Since the SubStateMachine is only used when “MyStateMachine” is in “State1”, a client would receive a Bad_StateNotActive StatusCode when reading the SubStateMachine CurrentState <a href="5ed97e29-a505-4050-af5d-8b2c8d80a045.htm">Variable</a> if “MyStateMachine” is in a different State.
            </p></div><h4 class="subHeading" id="StateMachineType_using_containment">
            StateMachineType using containment
          </h4><div class="subsection"><div class="mediaCenter"><img alt="Example of a StateMachineType using containment" src="../media/ExampleStateMachineTypeUsingContainment.JPG" /><div class="caption"><span class="captionLead">Figure 7:
						</span>Example of a StateMachineType using containment</div></div><p>
              Figure 7 gives an example of an <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> not only representing a StateMachine but also having some other functionality. The <a href="9d541e15-812b-4dce-9b4c-7b0d66e74daf.htm">ObjectType</a> “MyObjectType” has an Object “MyComponent” representing this other functionality. But is also contains a StateMachine “MyStateMachine” of the type “MyStateMachineType”. Objects of “MyObjectType” also contain such an Object representing the StateMachine and a <a href="5ed97e29-a505-4050-af5d-8b2c8d80a045.htm">Variable</a> containing the current state of the StateMachine, as shown in the Figure.
            </p></div><h4 class="subHeading" id="Example_of_a_StateMachine_having_Transitions_to_SubStateMachines">
            Example of a StateMachine having Transitions to SubStateMachines
          </h4><div class="subsection"><p>
              The StateMachines shown so far only had Transitions between States on the same level, i.e. on the same StateMachine. Of cause, it is possible and often required to have Transitions between States of the StateMachine and States of its SubStateMachine.
            </p><p>
              Because a SubStateMachine can be defined by another StateMachineType and this type can be used in several places, it is not possible to add a bi-directional Reference from one of the shared States of the SubStateMachine to another StateMachine. In this case it is suitable to expose the FromState or ToState References uni-directional, i.e. only pointing from the Transition to the State and not have the other direction browsable. If a Transition points from a State of a SubStateMachine to a State of another sub-machine, both, the FromState and the ToState Reference, are handled uni-directional.
            </p><p>
              A Client shall be able to handle the information of a StateMachine if the ToState and FromState References are only exposed as forward References and the inverse References are omitted.
            </p><p>
              Figure 8 gives an example of a state machine having a transition from a sub-state to a state.
            </p><div class="mediaCenter"><img alt="Example of a state machine with transitions from sub-states" src="../media/ExampleStateMachineTransitionsSub-states.JPG" /><div class="caption"><span class="captionLead">Figure 8:
						</span>Example of a state machine with transitions from sub-states</div></div><p>
              In Figure 9, the representation of this example as StateMachineType in the Address Space is given. The “Transition1”, part of the definition of “MyStateMachineType”, points to the “StateX” of the StateMachineType “AnotherStateMachineType”. The Reference is only exposed as forward Reference and the inverse Reference is omitted. Thus, there is no Reference from the “StateX” of “AnotherStateMachineType” to any part of “MyStateMachineType” and “AnotherStateMachineType” can be used in other places as well.
            </p><div class="mediaCenter"><img alt="Example of a StateMachineType having Transitions to SubStateMachines" src="../media/ExampleStateMachineTypeTransitionsSub-states.JPG" /><div class="caption"><span class="captionLead">Figure 9:
						</span>Example of a StateMachineType having Transitions to SubStateMachines</div></div></div></div></div></div><div id="pageFooter" class="pageFooter"><p><a href="http://www.commsvr.com/" target="_blank">Copyright (c) 2020 Mariusz Postol</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:techsupp%40cas.eu?Subject=OPC%20Unified%20Architecture">CAS</a></div>
        <script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>